{"version":3,"sources":["../../../src/test/auth/auth.test.js"],"names":["describe","beforeEach","done","User","deleteMany","err","it","user","name","email","password","app","post","send","set","expect","end","res","body","to","have","property","deep","be","an"],"mappings":";;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAPA;AASAA,QAAQ,CAAC,gCAAD,EAAmC,YAAM;AAC/CC,EAAAA,UAAU,CAAC,UAAAC,IAAI,EAAI;AACjB;AACAC,qBAAKC,UAAL,CAAgB,EAAhB,EAAoB,UAAAC,GAAG,EAAI;AACzBH,MAAAA,IAAI;AACL,KAFD;AAGD,GALS,CAAV;AAOAI,EAAAA,EAAE,CAAC,oCAAD,EAAuC,UAAAJ,IAAI,EAAI;AAC/C,QAAIK,IAAI,GAAG;AACTC,MAAAA,IAAI,EAAE,OADG;AAETC,MAAAA,KAAK,EAAE,gBAFE;AAGTC,MAAAA,QAAQ,EAAE;AAHD,KAAX;AAKA,+BAAQC,kBAAR,EACGC,IADH,CACQ,qBADR,EAEGC,IAFH,CAEQN,IAFR,EAGGO,GAHH,CAGO,QAHP,EAGiB,kBAHjB,EAIGC,MAJH,CAIU,cAJV,EAI0B,MAJ1B,EAKGA,MALH,CAKU,GALV,EAMGC,GANH,CAMO,UAACX,GAAD,EAAMY,GAAN,EAAc;AACjB,wBAAOA,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBC,QAAzB,CAAkC,SAAlC;AACA,wBAAOJ,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBE,IAAzB,CAA8BD,QAA9B,CACE,SADF,EAEE,2BAFF;AAIAnB,MAAAA,IAAI;AACL,KAbH;AAcD,GApBC,CAAF;AAsBAI,EAAAA,EAAE,CAAC,+EAAD,EAAkF,UAAAJ,IAAI,EAAI;AAC1F,QAAIK,IAAI,GAAG;AACTC,MAAAA,IAAI,EAAE,QADG;AAETC,MAAAA,KAAK,EAAE,gBAFE;AAGTC,MAAAA,QAAQ,EAAE;AAHD,KAAX;AAKA,+BAAQC,kBAAR,EACGC,IADH,CACQ,qBADR,EAEGC,IAFH,CAEQN,IAFR,EAGGO,GAHH,CAGO,QAHP,EAGiB,kBAHjB,EAIGC,MAJH,CAIU,cAJV,EAI0B,MAJ1B,EAKGA,MALH,CAKU,GALV,EAMGC,GANH,CAMO,UAACX,GAAD,EAAMY,GAAN,EAAc;AACjB,wBAAOA,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBC,QAAzB,CAAkC,OAAlC;AACA,wBAAOJ,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBE,IAAzB,CAA8BD,QAA9B,CAAuC,OAAvC,EAAgD,qBAAhD;AACAnB,MAAAA,IAAI;AACL,KAVH;AAWD,GAjBC,CAAF;AAmBAI,EAAAA,EAAE,CAAC,uDAAD,EAA0D,UAAAJ,IAAI,EAAI;AAClE,QAAIK,IAAI,GAAG;AACTE,MAAAA,KAAK,EAAE,kBADE;AAETC,MAAAA,QAAQ,EAAE;AAFD,KAAX;AAIA,+BAAQC,kBAAR,EACGC,IADH,CACQ,kBADR,EAEGC,IAFH,CAEQN,IAFR,EAGGO,GAHH,CAGO,QAHP,EAGiB,kBAHjB,EAIGC,MAJH,CAIU,cAJV,EAI0B,MAJ1B,EAKGA,MALH,CAKU,GALV,EAMGC,GANH,CAMO,UAACX,GAAD,EAAMY,GAAN,EAAc;AACjB,wBAAOA,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBI,EAApB,CAAuBC,EAAvB,CAA0B,QAA1B;AACA,wBAAOP,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBC,QAAzB,CAAkC,OAAlC;AACA,wBAAOJ,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBE,IAAzB,CAA8BD,QAA9B,CAAuC,OAAvC,EAAgD,gBAAhD;AACAnB,MAAAA,IAAI;AACL,KAXH;AAYD,GAjBC,CAAF;AAmBAI,EAAAA,EAAE,CAAC,0DAAD,EAA6D,UAAAJ,IAAI,EAAI;AACrE,QAAIK,IAAI,GAAG;AACTE,MAAAA,KAAK,EAAE,gBADE;AAETC,MAAAA,QAAQ,EAAE;AAFD,KAAX;AAIA,+BAAQC,kBAAR,EACGC,IADH,CACQ,kBADR,EAEGC,IAFH,CAEQN,IAFR,EAGGO,GAHH,CAGO,QAHP,EAGiB,kBAHjB,EAIGC,MAJH,CAIU,cAJV,EAI0B,MAJ1B,EAKGA,MALH,CAKU,GALV,EAMGC,GANH,CAMO,UAACX,GAAD,EAAMY,GAAN,EAAc;AACjB,wBAAOA,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBI,EAApB,CAAuBC,EAAvB,CAA0B,QAA1B;AACA,wBAAOP,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBC,QAAzB,CAAkC,OAAlC;AACA,wBAAOJ,GAAG,CAACC,IAAX,EAAiBC,EAAjB,CAAoBC,IAApB,CAAyBE,IAAzB,CAA8BD,QAA9B,CAAuC,OAAvC,EAAgD,oBAAhD;AACAnB,MAAAA,IAAI;AACL,KAXH;AAYD,GAjBC,CAAF;AAkBD,CAtFO,CAAR","sourcesContent":["/* eslint-disable no-undef */\r\nimport request from 'supertest';\r\nimport faker from 'faker';\r\nimport { expect } from 'chai';\r\nimport mongoose from 'mongoose';\r\nimport app from '../../server';\r\nimport assert from 'assert';\r\nimport User from '../../database/models/User';\r\n\r\ndescribe('[Authentication] /auth Testing', () => {\r\n  beforeEach(done => {\r\n    //Before each test we empty the database\r\n    User.deleteMany({}, err => {\r\n      done();\r\n    });\r\n  });\r\n\r\n  it('should be able to sign up new user', done => {\r\n    let user = {\r\n      name: 'admin',\r\n      email: 'admin@test.com',\r\n      password: '123456'\r\n    };\r\n    request(app)\r\n      .post('/api/auth/register/')\r\n      .send(user)\r\n      .set('Accept', 'application/json')\r\n      .expect('Content-Type', /json/)\r\n      .expect(201)\r\n      .end((err, res) => {\r\n        expect(res.body).to.have.property('message');\r\n        expect(res.body).to.have.deep.property(\r\n          'message',\r\n          'User created successfully'\r\n        );\r\n        done();\r\n      });\r\n  });\r\n\r\n  it('should not be able to sign up new user with an existing email in the database', done => {\r\n    let user = {\r\n      name: 'admin5',\r\n      email: 'admin@test.com',\r\n      password: '123456'\r\n    };\r\n    request(app)\r\n      .post('/api/auth/register/')\r\n      .send(user)\r\n      .set('Accept', 'application/json')\r\n      .expect('Content-Type', /json/)\r\n      .expect(400)\r\n      .end((err, res) => {\r\n        expect(res.body).to.have.property('error');\r\n        expect(res.body).to.have.deep.property('error', 'Email already exist');\r\n        done();\r\n      });\r\n  });\r\n\r\n  it('should not be able to sign in user with invalid email', done => {\r\n    let user = {\r\n      email: 'admin@test.com10',\r\n      password: '123456'\r\n    };\r\n    request(app)\r\n      .post('/api/auth/login/')\r\n      .send(user)\r\n      .set('Accept', 'application/json')\r\n      .expect('Content-Type', /json/)\r\n      .expect(401)\r\n      .end((err, res) => {\r\n        expect(res.body).to.be.an('object');\r\n        expect(res.body).to.have.property('error');\r\n        expect(res.body).to.have.deep.property('error', 'User not found');\r\n        done();\r\n      });\r\n  });\r\n\r\n  it('should not be able to sign in user with invalid password', done => {\r\n    let user = {\r\n      email: 'admin@test.com',\r\n      password: 'BadPass!'\r\n    };\r\n    request(app)\r\n      .post('/api/auth/login/')\r\n      .send(user)\r\n      .set('Accept', 'application/json')\r\n      .expect('Content-Type', /json/)\r\n      .expect(401)\r\n      .end((err, res) => {\r\n        expect(res.body).to.be.an('object');\r\n        expect(res.body).to.have.property('error');\r\n        expect(res.body).to.have.deep.property('error', 'Password incorrect');\r\n        done();\r\n      });\r\n  });\r\n});\r\n"],"file":"auth.test.js"}